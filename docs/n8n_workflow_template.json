{
  "name": "Daily English",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 9 * * *"
            }
          ]
        }
      },
      "id": "49a022a7-160c-428c-a6b7-041996851f24",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [-128, 0]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [192, 176],
      "id": "4ef49069-4c7a-424b-9d66-8658e3d20286",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "your-gemini-api-id",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [848, 176],
      "id": "17334441-0044-4c21-9dc2-b2c9874aed87",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "your-gemini-api-id",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const categories = [\n      \"ë¯¸êµ­ ì›ì–´ë¯¼ì´ ë§¤ì¼ ì“°ëŠ” ìƒí™œ í‘œí˜„\",\n      \"ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ…ì—ì„œ ê¼­ í•„ìš”í•œ ì˜ì–´ í‘œí˜„\",\n      \"ì—¬í–‰ì§€ì—ì„œ ìœ ìš©í•œ í•„ìˆ˜ ì˜ì–´ í‘œí˜„\",\n      \"ë¯¸ë“œë‚˜ ì˜í™”ì— ìì£¼ ë‚˜ì˜¤ëŠ” íŠ¸ë Œë””í•œ í‘œí˜„\",\n      \"ê°ì •ì„ í‘œí˜„í•˜ëŠ” ì„¬ì„¸í•œ ì˜ì–´ ë‹¨ì–´\",\n      \"ìì£¼ í‹€ë¦¬ëŠ” ì½©ê¸€ë¦¬ì‹œ êµì •\"\n    ];\n\n    const randomCategory = categories[Math.floor(Math.random() * categories.length)];\n\n    return {\n      json: {\n        category: randomCategory\n      }\n    };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [32, 0],
      "id": "31f3e88c-6f35-4579-bda1-95b6d8343c42",
      "name": "Pick Category"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Role: Professional English Teacher\n    Task: Suggest ONE useful English expression related to the category below.\n\n    Category: {{ $('Pick Category').item.json.category }}\n\n    Requirements:\n    1. The expression must be practical and widely used.\n    2. Output MUST be a clean JSON object.\n\n    Output Format (JSON):\n    {\n      \"expression\": \"Hold your horses\",\n      \"meaning\": \"ì ê¹ ê¸°ë‹¤ë¦¬ì„¸ìš” / ì§„ì •í•˜ì„¸ìš”\"\n    }",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.8,
      "position": [192, 0],
      "id": "48b77485-707a-4bdf-992d-04e2bd4ebabf",
      "name": "Gemini Expression Generator"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Role: Professional English Content Creator.\n    Task: Create a detailed study card for the following English expression.\n\n    Expression: {{ $('Gemini Expression Generator').item.json.expression }}\n    Meaning: {{ $('Gemini Expression Generator').item.json.meaning }}\n    Category: {{ $('Pick Category').item.json.category }}\n\n    Requirements:\n    1. Tone: Friendly, humorous, and engaging (target audience: 20-30s). Use emojis appropriately.\n    2. Constraint: Do NOT address the reader as \"Kids\", \"Students\", or \"Children\". Use a general, relatable tone suitable for young adults.\n    3. Output MUST be a valid JSON object matching the schema below.\n    4. 'content' field must be a nested JSON object.\n    5. Refer to the 'Example Output' below to maintain consistency in style and tone.\n\n    Example Output (Reference this style):\n    [\n      {\n        \"expression\": \"under the weather\",\n        \"meaning\": \"ëª¸ì´ ì¢€ ì•ˆ ì¢‹ì•„\",\n        \"content\": {\n          \"tip\": \"ğŸš¨ **ê¿€íŒ ë°©ì¶œ!** 'under the weather'ëŠ” ì§„ì§œ ì‹¬ê°í•˜ê²Œ ì•„í”Œ ë•Œë³´ë‹¤ëŠ” ê°€ë³ê²Œ 'ì»¨ë””ì…˜ì´ ì•ˆ ì¢‹ë‹¤', 'ê°ê¸° ê¸°ìš´ì´ ìˆë‹¤' ì •ë„ì˜ ëŠë‚Œì´ì—ìš”. ğŸ˜· ë§Œì•½ ì§„ì§œ ì‹¬í•˜ê²Œ ì•„í”„ë‹¤ë©´ 'I'm sick' ë˜ëŠ” 'I have a fever'ì²˜ëŸ¼ êµ¬ì²´ì ìœ¼ë¡œ ë§í•˜ëŠ” ê²Œ ì¢‹ì•„ìš”. ğŸ˜‰ ê·¸ë¦¬ê³  ì´ í‘œí˜„ì€ ë±ƒì‚¬ëŒë“¤ì´ ë°°ì—ì„œ ë‚ ì”¨ê°€ ì•ˆ ì¢‹ì„ ë•Œ ì•„í”ˆ ì‚¬ëŒì„ ê°‘íŒ ì•„ë˜ë¡œ ë³´ë‚´ 'ë‚ ì”¨ ì•„ë˜'ì— ìˆê²Œ í–ˆë‹¤ëŠ” ìœ ë˜ê°€ ìˆëŒ€ìš”! ì™„ì „ ì‹ ê¸°í•˜ì£ ? âš“ï¸ğŸŒŠ\",\n          \"quiz\": {\n            \"answer\": \"B\",\n            \"question\": \"ë‹¤ìŒ ì¤‘ 'I'm feeling a bit under the weather.'ì™€ ê°€ì¥ ë¹„ìŠ·í•œ ìƒí™©ì€?\\n\\nA. ğŸ¥³ íŒŒí‹°ì—ì„œ ì‹ ë‚˜ê²Œ ì¶¤ì¶”ê³  ìˆë‹¤.\\nB. ğŸ˜´ ì¹¨ëŒ€ì—ì„œ ë°ê¸°ì ê±°ë¦¬ë©° ëª¸ì´ ì¢€ ìœ¼ìŠ¬ìœ¼ìŠ¬í•˜ë‹¤.\\nC. ğŸ‹ï¸â€â™€ï¸ í—¬ìŠ¤ì¥ì—ì„œ ì—­ê¸°ë¥¼ ë“¤ê³  ìš´ë™í•˜ê³  ìˆë‹¤.\"\n          },\n          \"dialogue\": [\n            { \"en\": \"Hey, you look a bit down. Are you okay?\", \"kr\": \"ì•¼, ë„ˆ ì¢€ ì‹œë¬´ë£©í•´ ë³´ì¸ë‹¤. ê´œì°®ì•„?\" },\n            { \"en\": \"I'm feeling a bit under the weather today, so I think I'll just head home early.\", \"kr\": \"ì˜¤ëŠ˜ ëª¸ì´ ì¢€ ì•ˆ ì¢‹ì•„ì„œ, ì¼ì° ì§‘ì— ê°€ë ¤ê³  í•´.\" }\n          ],\n          \"situation\": \"ğŸŒŸ ì•„ì¹¨ì— ì¼ì–´ë‚¬ëŠ”ë° ì™ ì§€ ëª¨ë¥´ê²Œ ëª¸ì´ ì¶• ì²˜ì§€ê³ , ì»¨ë””ì…˜ì´ ë³„ë¡œì¼ ë•Œ! ğŸ˜± 'ì•„, ë‚˜ ì˜¤ëŠ˜ ë­”ê°€ ì¢€ ë³„ë¡ ë°... ë³‘ë“  ë³‘ì•„ë¦¬ ê°™ì•„...' í•  ë•Œ ì“°ëŠ” í•µì¸ì‹¸ í‘œí˜„ì´ì—ìš”! ì§„ì§œ ì•„í”ˆ ê±´ ì•„ë‹Œë° ê·¸ë ‡ë‹¤ê³  ì™„ì „ ìŒ©ìŒ©í•˜ì§€ë„ ì•Šì„ ë•Œ, ê°€ë³ê²Œ ë‚´ ìƒíƒœë¥¼ ë§í•˜ê³  ì‹¶ì„ ë•Œ ì°°ë–¡ê°™ì´ ì“¸ ìˆ˜ ìˆë‹µë‹ˆë‹¤! ğŸ¤’âœ¨\"\n        },\n        \"tags\": [\"daily\", \"health\"]\n      },\n      {\n        \"expression\": \"I'm swamped.\",\n        \"meaning\": \"ì¼ì´ ë„ˆë¬´ ë§ì•„ì„œ ì •ì‹ ì—†ì´ ë°”ë¹ ìš”! ğŸ¤¯\",\n        \"content\": {\n          \"tip\": \"'I'm busy'ë„ ë§ì§€ë§Œ, 'swamped'ëŠ” 'ë„ˆë¬´ ë°”ë¹ ì„œ ê°ë‹¹í•˜ê¸° í˜ë“¤ë‹¤'ëŠ” ëŠë‚Œì„ ë” ê°•í•˜ê²Œ ì „ë‹¬í•´ìš”. ğŸ˜µâ€ğŸ’« ë§ˆì¹˜ ì¼ì— ì ê²¨ì„œ í—ˆìš°ì ê±°ë¦¬ëŠ” ê·¸ë¦¼ì„ ë– ì˜¬ë¦¬ë©´ ì¢‹ì•„ìš”. ì‹œí—˜ ê¸°ê°„ì´ë‚˜ ë§ˆê°ì¼ì´ ì½”ì•ì¼ ë•Œ ì¨ë¨¹ê¸° ë”± ì¢‹ë‹µë‹ˆë‹¤! ğŸš€\",\n          \"quiz\": {\n            \"answer\": \"swamped\",\n            \"question\": \"ì£¼ë§ì— ì•½ì†ì´ ìˆëŠ”ë°, ê°‘ìê¸° ì¼ì´ ìŸì•„ì ¸ì„œ ëª» ê°ˆ ê²ƒ ê°™ì•„ìš”. ì´ëŸ´ ë•Œ ì“¸ ìˆ˜ ìˆëŠ” ê°€ì¥ ì ì ˆí•œ í‘œí˜„ì€? ğŸ¤” 'I'm ______.'\"\n          },\n          \"dialogue\": [\n            { \"en\": \"Hey, wanna grab some coffee after work?\", \"kr\": \"ì €ê¸°, í‡´ê·¼í•˜ê³  ì»¤í”¼ í•œ ì” í• ë˜ìš”?\" },\n            { \"en\": \"Oh, I'd love to, but I'm totally swamped with reports right now.\", \"kr\": \"ì•„, ê·¸ëŸ¬ê³  ì‹¶ì€ë° ì§€ê¸ˆ ë³´ê³ ì„œ ë•Œë¬¸ì— ì™„ì „ ì •ì‹ ì´ ì—†ì–´ìš”.\" }\n          ],\n          \"situation\": \"ê°€ë” ì—…ë¬´ë‚˜ ê³¼ì œ, ì•½ì†ì´ í•œêº¼ë²ˆì— ëª°ë ¤ì„œ ì •ì‹ ì´ í•˜ë‚˜ë„ ì—†ì„ ë•Œ ìˆì£ ? ğŸ˜± ë§ˆì¹˜ ëŠªì— ë¹ ì§„ ê²ƒì²˜ëŸ¼ í•  ì¼ì´ ë¨¸ë¦¬ ìœ„ê¹Œì§€ ì°¨ì˜¤ë¥¼ ë•Œ! 'ë‚˜ ì™„ì „ ë°”ë¹ ìš”!' ëŒ€ì‹  ì´ í‘œí˜„ì„ ì¨ë³´ì„¸ìš”. í›¨ì”¬ ìƒìƒí•˜ê²Œ ë‚´ ìƒí™©ì„ ì „ë‹¬í•  ìˆ˜ ìˆì–´ìš”. ğŸ˜‰\"\n        },\n        \"tags\": [\"daily\", \"emotion\", \"business\"]\n      },\n      {\n        \"expression\": \"Hang in there!\",\n        \"meaning\": \"í˜ë‚´! / ë²„í…¨! / ì¡°ê¸ˆë§Œ ë” ì°¸ê³  ê²¬ëŒ!\",\n        \"content\": {\n          \"tip\": \"ì´ í‘œí˜„ì€ 'Keep going!' (ê³„ì†í•´!), 'Don't give up!' (í¬ê¸°í•˜ì§€ ë§ˆ!)ì™€ ë¹„ìŠ·í•œ ë‰˜ì•™ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆì–´ìš”. ğŸ—£ï¸ ì¢Œì ˆí•˜ì§€ ì•Šê³  ëˆê¸° ìˆê²Œ ë²„í‹°ë¼ëŠ” ì‘ì›ì˜ ë©”ì‹œì§€ë¥¼ ë‹´ê³  ìˆì£ ! ë„ˆë¬´ ì‹¬ê°í•œ ìƒí™©ë³´ë‹¤ëŠ” ì¹œêµ¬ë‚˜ ë™ë£Œì—ê²Œ ê°€ë³ê²Œ ìš©ê¸°ë¥¼ ì¤„ ë•Œ ì•„ì£¼ ìœ ìš©í•˜ë‹µë‹ˆë‹¤! ğŸ˜Š 'Never give up!' ë³´ë‹¤ëŠ” ì¡°ê¸ˆ ë” ë¶€ë“œëŸ¬ìš´ ëŠë‚Œì´ì—ìš”. ğŸ’–\",\n          \"quiz\": {\n            \"answer\": \"b) Hang in there!\",\n            \"question\": \"ì¤‘ìš”í•œ ì‹œí—˜ì´ë‚˜ ë§ˆê° ì§ì „ ë„ˆë¬´ í˜ë“¤ì–´í•˜ê³  ìˆì„ ë•Œ, 'ì¡°ê¸ˆë§Œ ë” ë²„í…¨! ë„Œ í•  ìˆ˜ ìˆì–´!'ë¼ê³  ì‘ì›í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ì¤‘ ì–´ë–¤ í‘œí˜„ì´ ê°€ì¥ ì ì ˆí• ê¹Œìš”?\"\n          },\n          \"dialogue\": [\n            { \"en\": \"I'm so stressed about this final exam. I just want to give up!\", \"kr\": \"ë‚˜ ì´ ì‹œí—˜ ë•Œë¬¸ì— ë„ˆë¬´ ìŠ¤íŠ¸ë ˆìŠ¤ë°›ì•„. ê·¸ëƒ¥ í¬ê¸°í•˜ê³  ì‹¶ì–´!\" },\n            { \"en\": \"Hang in there! You've studied so hard, I'm sure you'll do great!\", \"kr\": \"í˜ë‚´! ë„ˆ ì •ë§ ì—´ì‹¬íˆ ê³µë¶€í–ˆì–ì•„, ë¶„ëª… ì˜í•  ê±°ì•¼!\" }\n          ],\n          \"situation\": \"ì‹œí—˜ ê¸°ê°„ì— ë°¤ìƒ˜ ê³µë¶€í•˜ë‹¤ê°€ ì§€ì³ ì“°ëŸ¬ì§ˆ ê²ƒ ê°™ì„ ë•Œ! ğŸ˜µâ€ğŸ’« ì•„ë‹ˆë©´ ìƒˆë¡œìš´ ë„ì „ì— ì§ë©´í•´ì„œ 'ì•„, ì§„ì§œ í¬ê¸°í•˜ê³  ì‹¶ë‹¤...'ë¼ëŠ” ìƒê°ì´ ë“¤ ë•Œ ìˆì–ì•„ìš”? ê·¸ëŸ´ ë•Œ ì“°ëŠ” ë§ˆë²•ì˜ ì£¼ë¬¸ì´ì—ìš”! âœ¨ 'ì¡°ê¸ˆë§Œ ë” í˜ë‚´!', 'ì¡°ê¸ˆë§Œ ë” ë²„í…¨!'ë¼ê³  ì‘ì›í•˜ê³  ì‹¶ì„ ë•Œ ì´ í‘œí˜„ì´ ë”±ì´ëë‹ˆë‹¤! ğŸ’ª ë§ˆì¹˜ ê²Œì„ì—ì„œ ë§ˆì§€ë§‰ ë³´ìŠ¤ë¥¼ ì¡ìœ¼ëŸ¬ ê°€ëŠ” ê¸¸ì— ì„œë¡œì—ê²Œ í¬ê¸°í•˜ì§€ ë§ë¼ê³  ì™¸ì¹˜ëŠ” ê²ƒê³¼ ê°™ì•„ìš”! ğŸ®\"\n        },\n        \"tags\": [\"daily\", \"encouragement\", \"friends\", \"motivation\", \"study\"]\n      }\n    ]\n\n    Output Format (JSON):\n    {\n      \"expression\": \"Expression here\",\n      \"meaning\": \"Korean meaning\",\n      \"content\": {\n        \"situation\": \"Detailed description of the situation where this expression is used (in Korean).\",\n        \"dialogue\": [\n          { \"en\": \"English sentence A\", \"kr\": \"Korean translation A\" },\n          { \"en\": \"English sentence B\", \"kr\": \"Korean translation B\" }\n        ],\n        \"tip\": \"Usage tips, nuances, or similar expressions (in Korean).\",\n        \"quiz\": {\n          \"question\": \"A short quiz question\",\n          \"answer\": \"Answer\"\n        }\n      },\n      \"tags\": [\"tag1\", \"tag2\", \"Category Name\"]\n    }",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.8,
      "position": [848, -16],
      "id": "02e5b67f-8823-4136-8714-9ad7ba0c183f",
      "name": "Gemini Content Generator"
    },
    {
      "parameters": {
        "useCustomSchema": true,
        "schema": "daily_english",
        "operation": "getAll",
        "tableId": "expressions",
        "returnAll": true,
        "filters": {
          "conditions": [
            {
              "keyName": "expression",
              "condition": "eq",
              "keyValue": "={{ $('Gemini Expression Generator').item.json.expression }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [480, 0],
      "id": "05db3f9a-0dfe-446c-9934-9b20d3f0dfb8",
      "name": "Check Duplicate",
      "alwaysOutputData": true,
      "credentials": {
        "supabaseApi": {
          "id": "your-supabase-api-id",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "7588390d-2c9b-4409-9df3-6e365605d4a6",
              "leftValue": "={{ $('Check Duplicate').first().json.expression }}",
              "rightValue": 0,
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [640, 0],
      "id": "a30b944b-27a7-4bb0-b814-5b0affb84127",
      "name": "If New"
    },
    {
      "parameters": {
        "useCustomSchema": true,
        "schema": "daily_english",
        "tableId": "expressions",
        "dataToSend": "autoMapInputData"
      },
      "id": "5386da96-09ac-46df-b5c5-ee701525c646",
      "name": "Supabase Insert",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [1312, -16],
      "credentials": {
        "supabaseApi": {
          "id": "your-supabase-api-id",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "  // Geminiì˜ ì‘ë‹µì—ì„œ JSON ë¬¸ìì—´ ë¶€ë¶„ë§Œ ì¶”ì¶œí•˜ì—¬ íŒŒì‹±í•©ë‹ˆë‹¤.\n  const rawText = $input.first().json.text;\n  // ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```json ... ```) ì œê±°\n  const cleanJson = rawText.replace(/```json/g, \"\").replace(/`/g, \"\").trim();\n\n  try {\n    return {\n      json: JSON.parse(cleanJson)\n    };\n  } catch (error) {\n    // íŒŒì‹± ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë¡œê·¸ ë°˜í™˜ (ë””ë²„ê¹…ìš©)\n    return {\n      json: {\n        error: \"JSON Parsing Failed\",\n        raw: rawText\n      }\n    };\n  }"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1152, -16],
      "id": "011ea8ef-35b2-4afe-bd4e-d55d9add6869",
      "name": "Parse JSON"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Pick Category",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Gemini Expression Generator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Gemini Content Generator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Pick Category": {
      "main": [
        [
          {
            "node": "Gemini Expression Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Expression Generator": {
      "main": [
        [
          {
            "node": "Check Duplicate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Content Generator": {
      "main": [
        [
          {
            "node": "Parse JSON",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Duplicate": {
      "main": [
        [
          {
            "node": "If New",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If New": {
      "main": [
        [
          {
            "node": "Gemini Content Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse JSON": {
      "main": [
        [
          {
            "node": "Supabase Insert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "your-version-id",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "your-instance-id"
  },
  "id": "your-workflow-id",
  "tags": []
}
